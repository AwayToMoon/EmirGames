<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <title>HigherCellF Games - Moderne Gaming Plattform</title>
    <link rel="icon" type="image/png" id="favicon" href="#">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Animated Background Particles -->
    <div class="particles-container">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
    </div>

    <div class="content-container">
        <!-- Header Section -->
        <header class="header">
                <div class="logo-title-container">
                <img id="header-logo" src="#" alt="HigherCellF Games Logo" class="header-logo">
                    <h1 class="site-title">HigherCellF Games</h1>
                </div>
                
            <nav class="social-media">
                <a href="https://ko-fi.com/awayy" class="kofi-btn" target="_blank" rel="noopener">
                        <i class="fas fa-mug-hot"></i>
                    <span>Support Mich Gern :D</span>
                    </a>
                    <div class="social-buttons">
                    <a href="#" class="social-btn" id="tiktok-btn" title="TikTok" target="_blank" rel="noopener">
                            <i class="fab fa-tiktok"></i>
                        </a>
                    <a href="#" class="social-btn" id="discord-btn" title="Discord" target="_blank" rel="noopener">
                            <i class="fab fa-discord"></i>
                        </a>
                    <a href="#" class="social-btn" id="instagram-btn" title="Instagram" target="_blank" rel="noopener">
                            <i class="fab fa-instagram"></i>
                        </a>
                    <a href="#" class="social-btn" id="kick-btn" title="Kick" target="_blank" rel="noopener">
                            <i class="fas fa-k"></i>
                        </a>
                </div>
            </nav>

                <div class="admin-section">
                    <img id="admin-logo" src="#" alt="Admin Logo" class="admin-logo">
                <button id="admin-login-btn" class="admin-login-btn discord-login-btn">
                    <i class="fab fa-discord"></i>
                    <span id="login-text">Admin Login</span>
                </button>
            </div>
        </header>
            
            <div class="header-divider"></div>

        <!-- Admin Panel -->
        <section id="admin-panel" class="admin-panel hidden">
            <div class="admin-user-info">
                <img id="admin-avatar" src="" alt="Admin Avatar" class="admin-avatar">
                <div class="admin-user-details">
                    <span id="admin-username" class="admin-username"></span>
                    <button id="logout-btn" class="logout-btn">
                        <i class="fas fa-sign-out-alt"></i>
                        Logout
                    </button>
                </div>
            </div>
            <button id="add-game-btn" class="admin-btn">
                <i class="fas fa-plus"></i>
                Spiel hinzuf√ºgen
            </button>
            <button id="edit-games-btn" class="admin-btn">
                <i class="fas fa-edit"></i>
                Spiele bearbeiten
            </button>
            <button id="edit-social-btn" class="admin-btn">
                <i class="fas fa-share-alt"></i>
                Social Media Links bearbeiten
            </button>
            <button id="view-suggestions-btn" class="admin-btn">
                <i class="fas fa-lightbulb"></i>
                Vorschl√§ge ansehen 
                <span id="suggestion-count" class="suggestion-badge hidden">0</span>
            </button>
        </section>

        <!-- Action Buttons -->
        <section class="action-buttons">
            <button id="game-randomizer" class="randomizer-btn">
                <i class="fas fa-dice"></i>
                Zuf√§lliges Spiel
            </button>
            <button id="suggest-game-btn" class="suggest-button">
                <i class="fas fa-plus-circle"></i>
                Spiel vorschlagen
            </button>
            <a href="https://minigames-emir.vercel.app/" class="minigames-button" target="_blank" rel="noopener">
                    <i class="fas fa-chevron-right"></i>
                    MiniGames Emir
                    <i class="fas fa-chevron-left"></i>
                </a>
        </section>
        
        <!-- Main Content -->
        <main class="main-content-flex">
            <!-- Genre Filter Sidebar -->
            <aside class="genre-filter-container">
                    <h3>Nach Genre filtern</h3>
                    <div class="genre-filter-buttons">
                    <button class="genre-filter-btn active" data-genre="all">
                        <i class="fas fa-th-large"></i>
                        Alle
                    </button>
                    <button class="genre-filter-btn" data-genre="Action">
                        <i class="fas fa-fire"></i>
                        Action
                    </button>
                    <button class="genre-filter-btn" data-genre="Adventure">
                        <i class="fas fa-compass"></i>
                        Adventure
                    </button>
                    <button class="genre-filter-btn" data-genre="Soulslike">
                        <i class="fas fa-skull"></i>
                        Soulslike
                    </button>
                    <button class="genre-filter-btn" data-genre="Shooter">
                        <i class="fas fa-crosshairs"></i>
                        Shooter
                    </button>
                    <button class="genre-filter-btn" data-genre="Sport">
                        <i class="fas fa-futbol"></i>
                        Sport
                    </button>
                    <button class="genre-filter-btn" data-genre="Strategie">
                        <i class="fas fa-chess"></i>
                        Strategie
                    </button>
                    <button class="genre-filter-btn" data-genre="R√§tsel">
                        <i class="fas fa-puzzle-piece"></i>
                        R√§tsel
                    </button>
                    <button class="genre-filter-btn" data-genre="Roblox">
                        <i class="fas fa-cube"></i>
                        Roblox
                    </button>
                    <button class="genre-filter-btn" data-genre="Horror">
                        <i class="fas fa-ghost"></i>
                        Horror
                    </button>
                    <button class="genre-filter-btn" data-genre="Story">
                        <i class="fas fa-book-open"></i>
                        Story
                    </button>
                </div>
            </aside>

            <!-- Games Content -->
            <div class="games-content">
                <nav class="game-tabs-container">
                    <button id="tab-all-games" class="game-tab-btn active">
                        <i class="fas fa-th-large"></i>
                        Alle Spiele
                    </button>
                    <button id="tab-unreleased-games" class="game-tab-btn">
                        <i class="fas fa-clock"></i>
                        Unreleased Spiele
                    </button>
                    <button id="tab-played-games" class="game-tab-btn">
                        <i class="fas fa-check-circle"></i>
                        Played Games
                    </button>
                </nav>
                
                <div id="game-list" class="game-list"></div>
            </div>
        </main>

        <!-- Modals -->
        <!-- Game Form Modal -->
            <div id="game-form" class="modal hidden">
                <div class="modal-content">
                    <span class="close-modal">&times;</span>
                <h2><i class="fas fa-plus-circle"></i> Spiel hinzuf√ºgen</h2>
                <div class="form-group">
                    <label for="steam-link">Steam-Link</label>
                    <input type="text" id="steam-link" placeholder="Steam-Link einf√ºgen">
                </div>
                <div id="steam-fetch-status" class="fetch-status hidden"></div>
                <div id="steam-preview" class="steam-preview hidden">
                    <img id="steam-image" src="" alt="Steam Bild">
                    <div class="preview-info">
                        <h3 id="steam-name"></h3>
                        <p id="steam-genres"></p>
                    </div>
                </div>
                <button id="save-game" class="save-btn">
                    <i class="fas fa-save"></i>
                    Speichern
                </button>
                </div>
            </div>

        <!-- Social Media Form Modal -->
            <div id="social-form" class="modal hidden">
                <div class="modal-content">
                    <span class="close-modal">&times;</span>
                <h2><i class="fas fa-share-alt"></i> Social Media Links bearbeiten</h2>
                
                <div class="form-section">
                    <h3>Header Social Media</h3>
                    <div class="form-group">
                        <label for="tiktok-link">TikTok URL</label>
                    <input type="text" id="tiktok-link" placeholder="TikTok URL">
                    </div>
                    <div class="form-group">
                        <label for="discord-link">Discord URL</label>
                    <input type="text" id="discord-link" placeholder="Discord URL">
                    </div>
                    <div class="form-group">
                        <label for="instagram-link">Instagram URL</label>
                    <input type="text" id="instagram-link" placeholder="Instagram URL">
                    </div>
                    <div class="form-group">
                        <label for="kick-link">Kick URL</label>
                    <input type="text" id="kick-link" placeholder="Kick URL">
                    </div>
                </div>

                <div class="form-section">
                    <h3>Footer Social Media</h3>
                    <div class="form-group">
                        <label for="footer-instagram-link">Footer Instagram URL</label>
                    <input type="text" id="footer-instagram-link" placeholder="Footer Instagram URL">
                    </div>
                    <div class="form-group">
                        <label for="footer-tiktok-link">Footer TikTok URL</label>
                    <input type="text" id="footer-tiktok-link" placeholder="Footer TikTok URL">
                    </div>
                    <div class="form-group">
                        <label for="footer-twitter-link">Footer Twitter URL</label>
                    <input type="text" id="footer-twitter-link" placeholder="Footer Twitter URL">
                    </div>
                </div>

                <div class="form-section">
                    <h3>Logo URLs</h3>
                    <div class="form-group">
                        <label for="header-logo-link">Header Logo URL</label>
                    <input type="text" id="header-logo-link" placeholder="Header Logo URL (empfohlen: 40x40px)">
                    </div>
                    <div class="form-group">
                        <label for="logo-link">Tab Icon URL</label>
                    <input type="text" id="logo-link" placeholder="Tab Icon URL (32x32px empfohlen)">
                    </div>
                    <div class="form-group">
                        <label for="admin-logo-link">Admin Logo URL</label>
                    <input type="text" id="admin-logo-link" placeholder="Admin Logo URL (empfohlen: 40x40px)">
                    </div>
                </div>

                <button id="save-social" class="save-btn">
                    <i class="fas fa-save"></i>
                    Speichern
                </button>
                </div>
            </div>

        <!-- Suggest Form Modal -->
            <div id="suggest-form" class="modal hidden">
                <div class="modal-content suggest-content">
                    <span class="close-modal">&times;</span>
                <h2><i class="fas fa-lightbulb"></i> Spiel vorschlagen</h2>
                <div class="form-group">
                    <label for="suggest-steam-link">Steam-Link</label>
                    <input type="text" id="suggest-steam-link" placeholder="Steam-Link einf√ºgen">
                </div>
                <div id="suggest-steam-fetch-status" class="fetch-status hidden"></div>
                <div id="suggest-steam-preview" class="steam-preview hidden">
                    <img id="suggest-steam-image" src="" alt="Steam Bild">
                    <div class="preview-info">
                        <h3 id="suggest-steam-name"></h3>
                        <p id="suggest-steam-genres"></p>
                    </div>
                </div>
                <button id="submit-suggestion" class="save-btn">
                    <i class="fas fa-paper-plane"></i>
                    Vorschlag einreichen
                </button>
                </div>
            </div>

        <!-- Footer -->
        <footer class="footer-container">
                <div class="made-by-container">
                    <div class="made-by">
                        Made With <span class="heart">‚ù§</span> from Away
                    </div>
                    <div class="footer-social">
                    <a href="#" class="footer-social-btn" id="footer-instagram" title="Instagram" target="_blank" rel="noopener">
                            <i class="fab fa-instagram"></i>
                        </a>
                    <a href="#" class="footer-social-btn" id="footer-tiktok" title="TikTok" target="_blank" rel="noopener">
                            <i class="fab fa-tiktok"></i>
                        </a>
                    <a href="#" class="footer-social-btn" id="footer-twitter" title="X (Twitter)" target="_blank" rel="noopener">
                            <i class="fa-solid fa-x"></i>
                        </a>
                    </div>

            </div>
            <div class="copyright">
                Copyright ¬© 2025 Marvin Weiss. Alle Rechte vorbehalten.
            </div>
        </footer>
    </div>
    
    <!-- Corner Image - Outside Footer -->
                    <div class="corner-image">
                        <img src="https://i.imgur.com/PQrHi8j.png" alt="Corner Image">
                    </div>
    
    <!-- Randomizer Modal -->
    <div id="randomizer-modal" class="modal hidden">
        <div class="modal-content randomizer-content">
            <h2><i class="fas fa-dice"></i> Dein zuf√§lliges Spiel ist...</h2>
            <div class="game-showcase">
                <div class="preview-container">
                    <!-- Wird dynamisch mit JavaScript gef√ºllt -->
                </div>
                <div class="game-card">
                    <img src="" alt="">
                    <h3></h3>
                </div>
            </div>
            <div class="button-container">
                <button class="play-button" id="play-random-game">
                    <i class="fas fa-play"></i>
                    Spielen
                </button>
                <button class="close-button" id="close-random-game">
                    <i class="fas fa-times"></i>
                    Schlie√üen
                </button>
            </div>
        </div>
    </div>
    
    <!-- Loading Indicator -->
    <div id="loading-indicator" class="loading-indicator hidden">
        <div class="loading-spinner"></div>
        <p>Lade Spiele...</p>
    </div>

    <!-- Notification System -->
    <div id="notification-container" class="notification-container"></div>
    
<script>
        // Discord OAuth Configuration
        const DISCORD_CLIENT_ID = '1399190229214302208';
        const DISCORD_REDIRECT_URI = 'https://emir-games.vercel.app/';
        const ADMIN_DISCORD_ID = '933524419882676254';
        
        // Firebase Configuration
    const encryptedConfig = "U2FsdGVkX1/2h2jz/okQRoolhPVQPafedlkbIfYoDr/bEIj6Qe4Gz4D+GJsaaQ5i7XVMwWJ+cqe94PGWRSvfQKwZHwpHdIr9YhzTEVGwzq0yCkU/7ZsA1fNW0THeJjRP5W+tborqv2W5F8pHhVoVtYy104eDojx6YeaaKd4zyAr36a1eAY82nlgIUMhzbl8s7LEWqoqk/w+4brkq8Gt7zZ2zkCij2mwXb8LEyZJBFSa0j62QdI8cKkSwBRw3MxO56KTu4tLFcbv7hhehDtKwM0PNJMkuDp+xldtmmvIOS56fR64kvsLXlkN/DSV+3MHLWFCHv/ry06NtgMy6aEz3mfFQUqP0uaTR+ohi3niWSNYJ+wMNgQsV6xiXj+VmKleN";
    
    function initFirebase() {
        const secretKey = "HigherCellF-Games-2024";
        const decrypted = CryptoJS.AES.decrypt(encryptedConfig, secretKey).toString(CryptoJS.enc.Utf8);
        const firebaseConfig = JSON.parse(decrypted);
        
        firebase.initializeApp(firebaseConfig);
        window.db = firebase.firestore();
    }

    initFirebase();

        // Discord OAuth Functions
        function initDiscordAuth() {
            const loginBtn = document.getElementById('admin-login-btn');
            const logoutBtn = document.getElementById('logout-btn');
            
            // Check if user is already logged in
            const session = getDiscordSession();
            if (session && session.access_token) {
                updateUIForLoggedInUser(session);
            } else {
                updateUIForLoggedOutUser();
            }
            
            // Login button click
            loginBtn.addEventListener('click', () => {
                if (getDiscordSession()) {
                    // Already logged in, show admin panel
                    document.getElementById('admin-panel').classList.remove('hidden');
                } else {
                    // Start Discord OAuth flow
                    startDiscordOAuth();
                }
            });
            
            // Logout button click
            if (logoutBtn) {
                logoutBtn.addEventListener('click', () => {
                    logoutDiscord();
                });
            }
        }
        
        function startDiscordOAuth() {
            const params = new URLSearchParams({
                client_id: DISCORD_CLIENT_ID,
                redirect_uri: DISCORD_REDIRECT_URI,
                response_type: 'code',
                scope: 'identify'
            });
            
            window.location.href = `https://discord.com/api/oauth2/authorize?${params}`;
        }
        
        function handleDiscordCallback() {
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get('code');
            
            if (code) {
                // Exchange code for token
                exchangeCodeForToken(code);
            }
        }
        
        async function exchangeCodeForToken(code) {
            try {
                // In a real app, you'd exchange the code server-side
                // For now, we'll simulate the process
                const response = await fetch('/api/discord/callback', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ code })
                });
                
                if (response.ok) {
                    const session = await response.json();
                    saveDiscordSession(session);
                    updateUIForLoggedInUser(session);
                    window.history.replaceState({}, document.title, window.location.pathname);
                }
            } catch (error) {
                console.error('Discord OAuth error:', error);
                showNotification('Fehler bei der Discord-Anmeldung', 'error');
            }
        }
        
        function saveDiscordSession(session) {
            localStorage.setItem('discord_session', JSON.stringify(session));
        }
        
        function getDiscordSession() {
            const session = localStorage.getItem('discord_session');
            return session ? JSON.parse(session) : null;
        }
        
        function updateUIForLoggedInUser(session) {
            const loginBtn = document.getElementById('admin-login-btn');
            const loginText = document.getElementById('login-text');
            const adminPanel = document.getElementById('admin-panel');
            const adminAvatar = document.getElementById('admin-avatar');
            const adminUsername = document.getElementById('admin-username');
            
            loginBtn.classList.add('logged-in');
            loginText.textContent = 'Admin';
            adminPanel.classList.remove('hidden');
            
            if (adminAvatar && session.avatar) {
                adminAvatar.src = `https://cdn.discordapp.com/avatars/${session.id}/${session.avatar}.png`;
            }
            
            if (adminUsername) {
                adminUsername.textContent = session.username;
            }
        }
        
        function updateUIForLoggedOutUser() {
            const loginBtn = document.getElementById('admin-login-btn');
            const loginText = document.getElementById('login-text');
            const adminPanel = document.getElementById('admin-panel');
            
            loginBtn.classList.remove('logged-in');
            loginText.textContent = 'Admin Login';
            adminPanel.classList.add('hidden');
        }
        
        function logoutDiscord() {
            localStorage.removeItem('discord_session');
            updateUIForLoggedOutUser();
            showNotification('Erfolgreich abgemeldet! üëã', 'success');
        }

        // Notification System
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notification-container');
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
                <button class="notification-close">&times;</button>
            `;
            
            container.appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                notification.classList.add('fade-out');
                setTimeout(() => notification.remove(), 300);
            }, 5000);
            
            // Manual close
            notification.querySelector('.notification-close').onclick = () => {
                notification.classList.add('fade-out');
                setTimeout(() => notification.remove(), 300);
            };
        }

        // Loading Indicator
        function showLoading() {
            document.getElementById('loading-indicator').classList.remove('hidden');
        }

        function hideLoading() {
            document.getElementById('loading-indicator').classList.add('hidden');
        }

        // Enhanced Modal Management
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('hidden');
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            
            // Focus first input if exists
            const firstInput = modal.querySelector('input');
            if (firstInput) firstInput.focus();
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.add('hidden');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Close modals when clicking outside
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.classList.add('hidden');
                e.target.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        });

        // Close modals with escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const openModals = document.querySelectorAll('.modal:not(.hidden)');
                openModals.forEach(modal => {
                    modal.classList.add('hidden');
                    modal.style.display = 'none';
                });
                document.body.style.overflow = 'auto';
            }
        });

        // Initialize tooltips
        function initTooltips() {
            const elements = document.querySelectorAll('[title]');
            elements.forEach(element => {
                element.addEventListener('mouseenter', (e) => {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'tooltip';
                    tooltip.textContent = e.target.title;
                    document.body.appendChild(tooltip);
                    
                    const rect = e.target.getBoundingClientRect();
                    tooltip.style.left = rect.left + (rect.width / 2) - (tooltip.offsetWidth / 2) + 'px';
                    tooltip.style.top = rect.top - tooltip.offsetHeight - 10 + 'px';
                });
                
                element.addEventListener('mouseleave', () => {
                    const tooltip = document.querySelector('.tooltip');
                    if (tooltip) tooltip.remove();
                });
            });
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            initTooltips();
            initDiscordAuth();
            handleDiscordCallback();
            showNotification('Willkommen bei HigherCellF Games! üéÆ', 'success');
        });
</script>
    
<script src="script.js"></script>
</body>
</html>
